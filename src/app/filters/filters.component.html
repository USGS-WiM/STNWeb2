<h1 mat-dialog-title>
    <i class="material-icons"> search </i>
    <span>Search WHISPers</span>
</h1>

<mat-dialog-content>
    <form
        [formGroup]="filtersForm"
        class="autocomplete-form"
        autocomplete="off"
    >
        <mat-divider></mat-divider>

        <mat-accordion>
            <!-- Event type expansion panel -->
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <b>Event(s)</b>
                    </mat-panel-title>
                    <mat-panel-description>
                        <span>
                            <div class="chiplist">
                                <mat-chip-list #eventChipList>
                                    <span *ngFor="let events of selectedEvents">
                                        <mat-chip
                                            [selectable]="selectable"
                                            [removable]="removable"
                                            (click)="stopPropagation($event)"
                                            (removed)="
                                                removeChip(
                                                    events,
                                                    selectedEvents,
                                                    'events'
                                                )
                                            "
                                            >{{ event }}
                                            <mat-icon
                                                matChipRemove
                                                *ngIf="removable"
                                                (click)="
                                                    stopPropagation($event)
                                                "
                                                >cancel</mat-icon
                                            >
                                        </mat-chip>
                                        <span
                                            *ngIf="
                                                selectedEvents.indexOf(event) <
                                                selectedEvents.length - 1
                                            "
                                            >and&nbsp;</span
                                        >
                                    </span>
                                </mat-chip-list>
                            </div>
                        </span>
                    </mat-panel-description>
                </mat-expansion-panel-header>
                <div>
                    <div class="autocomplete-input">
                        <mat-form-field class="full-width">
                            <input
                                type="text"
                                matInput
                                placeholder="Add Event"
                                aria-label="Add Event"
                                [matAutocomplete]="eventAutoComplete"
                                [formControl]="eventsControl"
                                (valueChanges)="
                                    addChip($event, selectedEvents, 'events')
                                "
                            />
                            <mat-autocomplete
                                #eventAutoComplete="matAutocomplete"
                                [displayWith]="displayFn"
                                (optionSelected)="
                                    addChip($event, selectedEvents, 'events')
                                "
                            >
                                <mat-option
                                    *ngFor="
                                        let events of filteredEvents | async
                                    "
                                    [value]="event_name"
                                >
                                    <span>{{ events.event_name }}</span>
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                    </div>
                </div>
            </mat-expansion-panel>
            <!--- end Event type expansion panel -->
        </mat-accordion>
    </form>
</mat-dialog-content>
<mat-dialog-actions>
    <div class="form-buttons-flex">
        <div>
            <button mat-button (click)="clearSelection()">
                <mat-icon class="material-icons">clear_all</mat-icon> Clear
                Selection
            </button>
            <button mat-button (click)="this.filtersDialogRef.close('cancel')">
                <mat-icon class="material-icons">cancel</mat-icon> Cancel
            </button>
        </div>
        <span class="text-small text-light"
            >Parameters are connected by the 'AND' logical operator</span
        >
        <div>
            <button mat-raised-button color="primary">
                <mat-icon class="material-icons">search</mat-icon> Search
            </button>
        </div>
    </div>
</mat-dialog-actions>
